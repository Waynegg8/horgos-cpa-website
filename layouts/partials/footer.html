<!-- 
  ==============================================================================
  Site Footer - Rebuilt based on hugo-requirements-final-updated.txt (sec 3.2)
  ==============================================================================
-->
<footer class="site-footer">
  <div class="container">
    <div class="site-footer__main">

      <!-- Region 1: LOGO & SEO -->
      <div class="site-footer__region site-footer__region--logo-seo">
        <div class="footer-logo-container">
          <a href="{{ $.Site.BaseURL | relURL }}" class="footer-logo">
            <img src="/uploads/images/general/general-logo.png" alt="{{ $.Site.Title }} Logo" class="footer-logo__img">
            <span class="footer-logo__text">HorgosCPA</span>
          </a>
        </div>
        {{/* Footer SEO 亦依頁面種類：首頁 > 該 section > 通用 */}}
        {{ if .IsHome }}
          {{ with .Site.Data.seo.homepage }}<div class="site-footer__seo-text"><p>{{ . | safeHTML }}</p></div>{{ end }}
        {{ else if eq .Kind "section" }}
          {{ $sectionKey := printf "%s_section" .Section }}
          {{ with index .Site.Data.seo $sectionKey }}<div class="site-footer__seo-text"><p>{{ . | safeHTML }}</p></div>{{ end }}
        {{ else }}
          {{ with .Site.Data.seo.global }}<div class="site-footer__seo-text"><p>{{ . | safeHTML }}</p></div>{{ end }}
        {{ end }}
      </div>

      <!-- Region 2: Company Info -->
      <div class="site-footer__region site-footer__region--company-info">
        <h3 class="footer-heading footer-heading--collapsible">
          <button class="footer-collapse-toggle" aria-expanded="true">
            <i class="fas fa-building"></i>
            公司資訊
          </button>
        </h3>
        <div class="footer-collapse-content">
          {{/* 讀取聯絡資訊（優先 contact，其次 Params 根層） */}}
          {{ $address := or .Site.Params.contact.address .Site.Params.address }}
          {{ $phone := or .Site.Params.contact.phone .Site.Params.phone }}
          {{ $email := or .Site.Params.contact.email .Site.Params.email }}
          {{ $hours := or .Site.Params.contact.opening_hours .Site.Params.opening_hours }}
          <ul class="footer-info-list">
            <li><i class="fas fa-map-marker-alt"></i> {{ $address | default "台中市西區建國路21號3樓之1" }}</li>
            <li><i class="fas fa-phone"></i> <a href="tel:{{ $phone | default "04-2220-5606" }}">{{ $phone | default "04-2220-5606" }}</a></li>
            <li><i class="fas fa-envelope"></i> <a href="mailto:{{ $email | default "admin@horgoscpa.com" }}">{{ $email | default "admin@horgoscpa.com" }}</a></li>
            <li><i class="fas fa-clock"></i> {{ $hours | default "週一至週五 08:30-17:30" }}</li>
          </ul>
          <!-- Business Status (dynamic) -->
          <div class="site-footer__business-status" id="footer-business-status">
            <!-- JS will populate this -->
          </div>
          <!-- Social Media -->
          <div class="site-footer__social">
            {{ $fb := or .Site.Params.widgets.social.facebook "horgoscpa" }}
            {{ $ig := or .Site.Params.widgets.social.instagram "horgoscpa" }}
            {{ $line := or .Site.Params.widgets.social.line "@208ihted" }}
            <a href="https://www.facebook.com/{{ $fb }}" class="social-link facebook" target="_blank" rel="noopener" aria-label="Facebook">
              <i class="fab fa-facebook-f"></i>
            </a>
            <a href="https://line.me/R/ti/p/{{ $line }}" class="social-link line" target="_blank" rel="noopener" aria-label="LINE">
              <i class="fab fa-line"></i>
            </a>
            <a href="https://www.instagram.com/{{ $ig }}" class="social-link instagram" target="_blank" rel="noopener" aria-label="Instagram">
              <i class="fab fa-instagram"></i>
            </a>
          </div>
        </div>
      </div>

      <!-- Region 3: Services -->
      <div class="site-footer__region site-footer__region--services">
        <h3 class="footer-heading footer-heading--collapsible">
          <button class="footer-collapse-toggle" aria-expanded="true">
            <i class="fas fa-briefcase"></i>
            服務項目
          </button>
        </h3>
        <div class="footer-collapse-content">
          {{ with .Site.Menus.footer_services }}
          <ul class="footer-links">
            {{ range . }}
            <li><a href="{{ .URL | relURL }}"><i class="{{ .Params.icon | default "fas fa-angle-right" }}"></i> {{ .Name }}</a></li>
            {{ end }}
          </ul>
          {{ end }}
        </div>
      </div>

      <!-- Region 4: Quick Links -->
      <div class="site-footer__region site-footer__region--quick-links">
        <h3 class="footer-heading footer-heading--collapsible">
          <button class="footer-collapse-toggle" aria-expanded="true">
            <i class="fas fa-link"></i>
            快速連結
          </button>
        </h3>
        <div class="footer-collapse-content">
          {{ with .Site.Menus.footer_quicklinks }}
          <ul class="footer-links">
            {{ range . }}
            <li><a href="{{ .URL | relURL }}"><i class="{{ .Params.icon | default "fas fa-angle-right" }}"></i> {{ .Name }}</a></li>
            {{ end }}
          </ul>
          {{ end }}
        </div>
      </div>
    </div>
  </div>
  
  <!-- Region 5: Bottom Legal Bar -->
  <div class="site-footer__bottom">
    <div class="container site-footer__bottom-container">
      <div class="site-footer__copyright">
        <p>&copy; {{ now.Format "2006" }} {{ .Site.Params.copyright | default .Site.Title }} 版權所有</p>
      </div>
      <div class="site-footer__legal-links">
        {{ with .Site.Menus.footer_legal }}
          {{ range $index, $element := . }}
            {{ if gt $index 0 }}<span class="separator">|</span>{{ end }}
            <a href="{{ .URL | relURL }}">
              <i class="{{ .Params.icon }}"></i> {{ .Name }}
            </a>
          {{ end }}
        {{ end }}
      </div>
    </div>
  </div>
</footer>
