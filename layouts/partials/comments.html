<!-- 簡化討論區功能模板 -->
<div class="comments-section" id="comments">
  <h2 class="comments-title">留言討論</h2>
  
  <!-- Disqus討論區整合 -->
  <div id="disqus_thread"></div>
  
  <script>
    // Disqus配置
    var disqus_config = function () {
      this.page.url = "{{ .Permalink }}";
      this.page.identifier = "{{ .File.UniqueID }}";
      this.page.title = "{{ .Title }}";
    };
    
    // 載入Disqus
    (function() {
      var d = document, s = d.createElement('script');
      s.src = 'https://hugo-accounting.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
    
    // 延遲載入Disqus
    function loadDisqus() {
      var disqus_thread = document.getElementById('disqus_thread');
      var disqus_script = document.createElement('script');
      disqus_script.src = 'https://hugo-accounting.disqus.com/embed.js';
      disqus_script.setAttribute('data-timestamp', +new Date());
      (document.head || document.body).appendChild(disqus_script);
      
      // 移除事件監聽器
      window.removeEventListener('scroll', disqusScrollHandler);
    }
    
    // 監聽滾動事件
    function disqusScrollHandler() {
      var disqus_thread = document.getElementById('disqus_thread');
      if (disqus_thread) {
        var rect = disqus_thread.getBoundingClientRect();
        if (rect.top < window.innerHeight && rect.bottom >= 0) {
          loadDisqus();
        }
      }
    }
    
    // 添加滾動事件監聽器
    window.addEventListener('scroll', disqusScrollHandler);
    
    // 初始檢查
    document.addEventListener('DOMContentLoaded', disqusScrollHandler);
  </script>
  
  <noscript>請啟用JavaScript以查看 <a href="https://disqus.com/?ref_noscript">由Disqus提供的留言功能</a></noscript>
</div>