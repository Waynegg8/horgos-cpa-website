<!-- 下載列表頁 -->
<div class="download-list">
    <!-- 分類搜索標籤 -->
    <div class="category-nav card-style">
        <div class="category-nav__links">
            <button class="category-nav__link category-search-btn active" data-category="all">
                <i class="fas fa-download"></i>
                <span>全部下載</span>
            </button>
            <button class="category-nav__link category-search-btn" data-category="templates">
                <i class="fas fa-file-word"></i>
                <span>範本下載</span>
            </button>
            <button class="category-nav__link category-search-btn" data-category="forms">
                <i class="fas fa-file-alt"></i>
                <span>表格下載</span>
            </button>
            <button class="category-nav__link category-search-btn" data-category="checklists">
                <i class="fas fa-tasks"></i>
                <span>檢查清單</span>
            </button>
            <button class="category-nav__link category-search-btn" data-category="regulations">
                <i class="fas fa-gavel"></i>
                <span>法規文件</span>
            </button>
        </div>
    </div>
    
    <!-- 下載列表 -->
    <div class="download-list__grid">
        {{ $paginator := .Paginate (where .Pages "Type" "downloads") 10 }}
        {{ range $paginator.Pages }}
        <a href="{{ .RelPermalink }}" class="card-style card-clickable download-item" 
           data-category="{{ .Params.category | default "other" }}" 
           data-title="{{ .Title }}" 
           data-summary="{{ .Summary }}">
            <div class="card-horizontal">
                <div class="card-horizontal__icon">
                    {{ if eq .Params.filetype "pdf" }}
                    <i class="far fa-file-pdf" style="color: #dc3545;"></i>
                    {{ else if eq .Params.filetype "docx" }}
                    <i class="far fa-file-word" style="color: #0d6efd;"></i>
                    {{ else if eq .Params.filetype "xlsx" }}
                    <i class="far fa-file-excel" style="color: #198754;"></i>
                    {{ else if eq .Params.filetype "zip" }}
                    <i class="far fa-file-archive" style="color: #6f42c1;"></i>
                    {{ else }}
                    <i class="far fa-file"></i>
                    {{ end }}
                </div>
                <div class="card-horizontal__content">
                    <h2 class="download-title">{{ .Title }}</h2>
                    <div class="download-meta">
                        <span class="download-meta__item"><i class="fas fa-file"></i> {{ .Params.filetype | upper }}</span>
                        {{ with .Params.filesize }}<span class="download-meta__item"><i class="fas fa-weight"></i> {{ . }}</span>{{ end }}
                        <span class="download-meta__item"><i class="fas fa-calendar-alt"></i> {{ .Date.Format "2006-01-02" }}</span>
                        {{ with .Params.category }}<span class="download-meta__item"><i class="fas fa-folder"></i> {{ . }}</span>{{ end }}
                    </div>
                    <p class="download-summary">{{ .Summary | truncate 100 }}</p>
                </div>
            </div>
        </a>
        {{ end }}
    </div>
    
    <!-- 分頁導航 -->
    {{ if gt .Paginator.TotalPages 1 }}
    <nav class="pagination" role="navigation" aria-label="分頁導航">
        <div class="pagination__info">
            第 {{ .Paginator.PageNumber }} / {{ .Paginator.TotalPages }} 頁，共 {{ .Paginator.TotalNumberOfElements }} 個資源
        </div>
        <div class="pagination__controls">
            {{ if .Paginator.HasPrev }}
                <a href="{{ .Paginator.Prev.URL }}" class="pagination__link pagination__link--prev" aria-label="上一頁">
                    <i class="fas fa-chevron-left"></i>
                    上一頁
                </a>
            {{ end }}
            
            {{ range .Paginator.Pagers }}
                {{ if eq . $.Paginator }}
                    <span class="pagination__link pagination__link--current" aria-current="page">{{ .PageNumber }}</span>
                {{ else }}
                    <a href="{{ .URL }}" class="pagination__link">{{ .PageNumber }}</a>
                {{ end }}
            {{ end }}
            
            {{ if .Paginator.HasNext }}
                <a href="{{ .Paginator.Next.URL }}" class="pagination__link pagination__link--next" aria-label="下一頁">
                    下一頁
                    <i class="fas fa-chevron-right"></i>
                </a>
            {{ end }}
        </div>
    </nav>
    {{ end }}
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const categoryButtons = document.querySelectorAll('.category-search-btn');
    const downloadItems = document.querySelectorAll('.download-item');
    
    // 分類標籤點擊事件
    categoryButtons.forEach(button => {
        button.addEventListener('click', function() {
            const category = this.dataset.category;
            
            // 更新按鈕狀態
            categoryButtons.forEach(btn => btn.classList.remove('active'));
            this.classList.add('active');
            
            // 篩選下載項目
            downloadItems.forEach(item => {
                const itemCategory = item.dataset.category;
                
                if (category === 'all' || itemCategory === category) {
                    item.style.display = 'block';
                } else {
                    item.style.display = 'none';
                }
            });
        });
    });
});
</script>