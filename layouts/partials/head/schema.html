<!-- 結構化資料 Schema.org JSON-LD -->
{{ $schema := dict }}

<!-- 基本組織資訊 -->
{{ $organization := dict 
  "@type" "AccountingService" 
  "name" "Hugo會計師事務所" 
  "url" "https://hugo-accounting.com/" 
  "logo" "https://hugo-accounting.com/logo.png" 
  "telephone" "(04) 2345-6789" 
  "email" "contact@hugo-accounting.com" 
  "description" "專業的會計師事務所，提供工商登記、稅務申報、財稅簽證與諮詢服務。"
  "address" (dict 
    "@type" "PostalAddress" 
    "streetAddress" "台中市西區民生路123號5樓" 
    "addressLocality" "台中市" 
    "addressRegion" "台中市" 
    "postalCode" "40341" 
    "addressCountry" "TW"
  )
  "openingHoursSpecification" (slice 
    (dict 
      "@type" "OpeningHoursSpecification" 
      "dayOfWeek" (slice "Monday" "Tuesday" "Wednesday" "Thursday" "Friday") 
      "opens" "08:30" 
      "closes" "12:30"
    )
    (dict 
      "@type" "OpeningHoursSpecification" 
      "dayOfWeek" (slice "Monday" "Tuesday" "Wednesday" "Thursday" "Friday") 
      "opens" "13:30" 
      "closes" "17:30"
    )
  )
}}

<!-- 根據頁面類型設置不同的結構化資料 -->
{{ if .IsHome }}
  <!-- 首頁 - 組織資訊 -->
  {{ $schema = dict "@context" "https://schema.org" "@type" "Organization" | merge $organization }}

{{ else if eq .Section "articles" }}
  <!-- 文章頁面 -->
  {{ if .IsPage }}
    <!-- 單篇文章頁面 -->
    {{ $schema = dict 
      "@context" "https://schema.org" 
      "@type" "Article" 
      "headline" .Title 
      "description" .Description 
      "image" (or .Params.cover "/logo.png") 
      "datePublished" (.Date.Format "2006-01-02T15:04:05-07:00") 
      "dateModified" (.Lastmod.Format "2006-01-02T15:04:05-07:00") 
      "author" (dict 
        "@type" "Person" 
        "name" (or .Params.author "Hugo會計師事務所")
      )
      "publisher" $organization
    }}
  {{ else }}
    <!-- 文章列表頁面 -->
    {{ $schema = dict 
      "@context" "https://schema.org" 
      "@type" "CollectionPage" 
      "headline" .Title 
      "description" .Description 
      "publisher" $organization
    }}
  {{ end }}

{{ else if eq .Section "services" }}
  <!-- 服務項目頁面 -->
  {{ if .IsPage }}
    <!-- 單一服務頁面 -->
    {{ $schema = dict 
      "@context" "https://schema.org" 
      "@type" "Service" 
      "name" .Title 
      "description" .Description 
      "provider" $organization 
      "serviceType" .Title
    }}
  {{ else }}
    <!-- 服務列表頁面 -->
    {{ $schema = dict 
      "@context" "https://schema.org" 
      "@type" "ItemList" 
      "itemListElement" (slice)
    }}
    {{ $services := where .Site.RegularPages "Section" "services" }}
    {{ range $index, $service := $services }}
      {{ $listItem := dict 
        "@type" "ListItem" 
        "position" (add $index 1) 
        "url" $service.Permalink 
        "name" $service.Title 
        "description" $service.Description
      }}
      {{ $schema = merge $schema (dict "itemListElement" (append $schema.itemListElement $listItem)) }}
    {{ end }}
  {{ end }}

{{ else if eq .Section "faq" }}
  <!-- FAQ頁面 -->
  {{ if .IsPage }}
    <!-- 單一問題頁面 -->
    {{ $schema = dict 
      "@context" "https://schema.org" 
      "@type" "QAPage" 
      "mainEntity" (dict 
        "@type" "Question" 
        "name" .Title 
        "text" .Title 
        "dateCreated" (.Date.Format "2006-01-02T15:04:05-07:00") 
        "author" (dict "@type" "Organization" "name" "Hugo會計師事務所") 
        "acceptedAnswer" (dict 
          "@type" "Answer" 
          "text" .Content 
          "dateCreated" (.Date.Format "2006-01-02T15:04:05-07:00") 
          "author" (dict "@type" "Organization" "name" "Hugo會計師事務所")
        )
      )
    }}
  {{ else }}
    <!-- FAQ列表頁面 -->
    {{ $schema = dict 
      "@context" "https://schema.org" 
      "@type" "FAQPage" 
      "mainEntity" (slice)
    }}
    {{ $faqs := where .Site.RegularPages "Section" "faq" }}
    {{ range $faq := first 10 $faqs }}
      {{ $faqItem := dict 
        "@type" "Question" 
        "name" $faq.Title 
        "acceptedAnswer" (dict 
          "@type" "Answer" 
          "text" (or $faq.Description $faq.Summary)
        )
      }}
      {{ $schema = merge $schema (dict "mainEntity" (append $schema.mainEntity $faqItem)) }}
    {{ end }}
  {{ end }}

{{ else if eq .Section "videos" }}
  <!-- 影片頁面 -->
  {{ if .IsPage }}
    <!-- 單一影片頁面 -->
    {{ $videoType := "https://schema.org/VideoObject" }}
    {{ $videoUrl := "" }}
    {{ if eq .Params.video_platform "youtube" }}
      {{ $videoUrl = printf "https://www.youtube.com/watch?v=%s" .Params.video_id }}
    {{ else if eq .Params.video_platform "vimeo" }}
      {{ $videoUrl = printf "https://vimeo.com/%s" .Params.video_id }}
    {{ end }}
    
    {{ $schema = dict 
      "@context" "https://schema.org" 
      "@type" "VideoObject" 
      "name" .Title 
      "description" .Description 
      "thumbnailUrl" (or .Params.thumbnail (printf "https://i.ytimg.com/vi/%s/maxresdefault.jpg" .Params.video_id)) 
      "uploadDate" (.Date.Format "2006-01-02T15:04:05-07:00") 
      "contentUrl" $videoUrl 
      "embedUrl" (cond (eq .Params.video_platform "youtube") 
        (printf "https://www.youtube.com/embed/%s" .Params.video_id) 
        (printf "https://player.vimeo.com/video/%s" .Params.video_id)
      )
      "duration" .Params.duration
      "publisher" $organization
    }}
  {{ else }}
    <!-- 影片列表頁面 -->
    {{ $schema = dict 
      "@context" "https://schema.org" 
      "@type" "ItemList" 
      "itemListElement" (slice)
    }}
    {{ $videos := where .Site.RegularPages "Section" "videos" }}
    {{ range $index, $video := $videos }}
      {{ $listItem := dict 
        "@type" "ListItem" 
        "position" (add $index 1) 
        "url" $video.Permalink 
        "name" $video.Title 
        "description" $video.Description
      }}
      {{ $schema = merge $schema (dict "itemListElement" (append $schema.itemListElement $listItem)) }}
    {{ end }}
  {{ end }}

{{ else if eq .Section "downloads" }}
  <!-- 下載專區頁面 -->
  {{ if .IsPage }}
    <!-- 單一下載頁面 -->
    {{ $schema = dict 
      "@context" "https://schema.org" 
      "@type" "DigitalDocument" 
      "name" .Title 
      "description" .Description 
      "dateCreated" (.Date.Format "2006-01-02T15:04:05-07:00") 
      "dateModified" (or (.Params.update_date.Format "2006-01-02T15:04:05-07:00") (.Lastmod.Format "2006-01-02T15:04:05-07:00")) 
      "fileFormat" (or .Params.file_type "application/octet-stream")
    }}
  {{ else }}
    <!-- 下載列表頁面 -->
    {{ $schema = dict 
      "@context" "https://schema.org" 
      "@type" "ItemList" 
      "itemListElement" (slice)
    }}
    {{ $downloads := where .Site.RegularPages "Section" "downloads" }}
    {{ range $index, $download := $downloads }}
      {{ $listItem := dict 
        "@type" "ListItem" 
        "position" (add $index 1) 
        "url" $download.Permalink 
        "name" $download.Title 
        "description" $download.Description
      }}
      {{ $schema = merge $schema (dict "itemListElement" (append $schema.itemListElement $listItem)) }}
    {{ end }}
  {{ end }}

{{ else if eq .Section "about" }}
  <!-- 關於我們頁面 -->
  {{ $schema = dict "@context" "https://schema.org" "@type" "AboutPage" | merge $organization }}

{{ else if eq .Section "contact" }}
  <!-- 聯絡我們頁面 -->
  {{ $schema = dict "@context" "https://schema.org" "@type" "ContactPage" | merge $organization }}

{{ else if eq .Section "appointment" }}
  <!-- 預約諮詢頁面 -->
  {{ $schema = dict 
    "@context" "https://schema.org" 
    "@type" "WebPage" 
    "name" .Title 
    "description" .Description 
    "publisher" $organization
  }}

{{ else }}
  <!-- 其他頁面 -->
  {{ $schema = dict 
    "@context" "https://schema.org" 
    "@type" "WebPage" 
    "name" .Title 
    "description" .Description 
    "publisher" $organization
  }}
{{ end }}

<!-- 輸出結構化資料 -->
<script type="application/ld+json">
{{ $schema | jsonify | safeJS }}
</script>