{# src/_includes/partials/share-buttons.njk #}
{#
  通用分享按鈕組件。
  可以接受一個 `shareUrl` 變數來指定分享的 URL，如果未提供則使用當前頁面 URL。
  `shareTitle` 變數用於分享時的標題。
  符合藍圖的分享按鈕視覺設計要求。
#}
{% set currentShareUrl = shareUrl or site.baseUrl + page.url %}
{% set currentShareTitle = shareTitle or title or seo.defaultTitle %}

<div class="bg-white p-6 rounded-lg shadow-md mb-6">
  <h3 class="text-xl font-heading font-bold text-brand-blue-700 mb-4">分享此內容</h3>
  <div class="flex flex-wrap gap-3">
    {# Line 分享按鈕 #}
    <a href="https://social-plugins.line.me/lineit/share?url={{ currentShareUrl | urlencode }}&text={{ currentShareTitle | urlencode }}"
       target="_blank" rel="noopener noreferrer"
       class="inline-flex items-center justify-center bg-brand-blue-600 text-white font-semibold py-2 px-4 rounded-lg
              hover:bg-brand-blue-700 transition-colors duration-200 text-sm h-11 min-w-[44px] shadow-md hover:shadow-lg"
       aria-label="分享到 Line">
      <img src="https://simpleicons.org/icons/line.svg" alt="Line" class="w-5 h-5 mr-2">
      Line
    </a>

    {# 複製連結按鈕 #}
    <button class="share-copy-btn inline-flex items-center justify-center bg-gray-200 text-gray-700 font-semibold py-2 px-4 rounded-lg
                   hover:bg-gray-300 transition-colors duration-200 text-sm h-11 min-w-[44px] shadow-md hover:shadow-lg"
            data-share-url="{{ currentShareUrl }}"
            aria-label="複製連結">
      <span class="material-icons mr-2 text-xl">content_copy</span>
      複製連結
    </button>

    {# Facebook 分享 (可選) #}
    <a href="https://www.facebook.com/sharer/sharer.php?u={{ currentShareUrl | urlencode }}"
       target="_blank" rel="noopener noreferrer"
       class="inline-flex items-center justify-center bg-[#1877F2] text-white font-semibold py-2 px-4 rounded-lg
              hover:opacity-90 transition-opacity duration-200 text-sm h-11 min-w-[44px] shadow-md hover:shadow-lg"
       aria-label="分享到 Facebook">
      <img src="https://simpleicons.org/icons/facebook.svg" alt="Facebook" class="w-5 h-5 mr-2">
      Facebook
    </a>

    {# Twitter/X 分享 (可選) #}
    <a href="https://twitter.com/intent/tweet?url={{ currentShareUrl | urlencode }}&text={{ currentShareTitle | urlencode }}"
       target="_blank" rel="noopener noreferrer"
       class="inline-flex items-center justify-center bg-[#1DA1F2] text-white font-semibold py-2 px-4 rounded-lg
              hover:opacity-90 transition-opacity duration-200 text-sm h-11 min-w-[44px] shadow-md hover:shadow-lg"
       aria-label="分享到 X (Twitter)">
      <img src="https://simpleicons.org/icons/x.svg" alt="X (Twitter)" class="w-5 h-5 mr-2">
      X
    </a>
  </div>
</div>

{# 複製連結的 JavaScript 邏輯 #}
<script>
  document.addEventListener('DOMContentLoaded', () => {
    document.querySelectorAll('.share-copy-btn').forEach(button => {
      button.addEventListener('click', async () => {
        const urlToCopy = button.dataset.shareUrl;
        try {
          await navigator.clipboard.writeText(urlToCopy);
          alert('連結已複製！');
        } catch (err) {
          console.error('無法複製連結:', err);
          alert('複製失敗，請手動複製此連結：' + urlToCopy);
        }
      });
    });
  });
</script>