---
layout: layouts/base.njk # 繼承基礎佈局
eleventyComputed:
  # 從影片資料中獲取 SEO 相關資訊
  title: "{{ title }} | 霍爾果斯會計師事務所"
  description: "{{ meta_description or excerpt }}"
  image: "{{ thumbnailUrl }}" # 影片縮圖
  permalink: "/video/{{ slug }}/" # 確保 URL 結構正確
  scriptContent: |
    {# 此處可放置影片頁面專用的 JavaScript #}
    console.log("Video page loaded: {{ title }}");
---

<main class="container mx-auto px-4 py-8 md:py-12">
  <article class="flex flex-col lg:flex-row gap-8">
    {# 主內容區塊 #}
    <div class="w-full lg:w-3/4">
      <header class="mb-6">
        <h1 class="text-brand-blue-700 text-4xl md:text-5xl font-heading font-extrabold leading-tight mb-4">{{ title }}</h1>
        <p class="text-gray-600 text-lg mb-4">
          發布日期：<time datetime="{{ date }}">{{ date | formatDate }}</time>
          {% if tags and tags.length %}
            <span class="ml-4">
              {% for tag in tags %}
                <span class="inline-block bg-brand-blue-100 text-brand-blue-800 text-xs font-semibold px-2.5 py-0.5 rounded-full mr-2">{{ tag }}</span>
              {% endfor %}
            </span>
          {% endif %}
        </p>
      </header>

      {# 影片播放器 #}
      {% if videoUrl %}
        <div class="relative w-full aspect-video rounded-lg overflow-hidden shadow-md mb-8">
          {# 這裡假設 videoUrl 是可以直接嵌入的 YouTube 或其他平台連結 #}
          {# For YouTube, use an iframe with embed URL #}
          <iframe
            src="{{ videoUrl | replace('watch?v=', 'embed/') }}?autoplay=0&modestbranding=1&rel=0"
            frameborder="0"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
            allowfullscreen
            class="absolute top-0 left-0 w-full h-full"
            title="{{ title }}"
          ></iframe>
          {# 如果影片是本地檔案，可以使用 <video> 標籤 #}
          {# <video controls poster="{{ thumbnailUrl }}" class="w-full h-full object-cover">
            <source src="{{ videoUrl }}" type="video/mp4">
            您的瀏覽器不支持影片標籤。
          </video> #}
        </div>
      {% endif %}

      <div class="prose max-w-none text-gray-800 leading-relaxed text-lg mb-8">
        {{ content | markdownify | safe }} {# 這裡的 content 來自 videos.json #}
      </div>

      {# 上一篇/下一篇導航 #}
      <nav class="flex justify-between items-center mt-8 pt-4 border-t border-gray-200">
        {% if prev_video %}
          <a href="/video/{{ prev_video.slug }}/" class="flex items-center text-brand-blue-600 hover:text-brand-blue-800 transition duration-200 group">
            <span class="material-icons text-2xl mr-2">arrow_back</span>
            <span class="flex flex-col">
              <span class="text-sm text-gray-500">上一篇</span>
              <span class="font-semibold group-hover:underline">{{ prev_video.title }}</span>
            </span>
          </a>
        {% else %}
          <div></div> {# 保持排版 #}
        {% endif %}

        {% if next_video %}
          <a href="/video/{{ next_video.slug }}/" class="flex items-center text-brand-blue-600 hover:text-brand-blue-800 transition duration-200 group">
            <span class="flex flex-col text-right">
              <span class="text-sm text-gray-500">下一篇</span>
              <span class="font-semibold group-hover:underline">{{ next_video.title }}</span>
            </span>
            <span class="material-icons text-2xl ml-2">arrow_forward</span>
          </a>
        {% else %}
          <div></div> {# 保持排版 #}
        {% endif %}
      </nav>
    </div>

    {# 側邊欄 #}
    <aside class="w-full lg:w-1/4 lg:sticky lg:top-8 self-start">
      {# 分享按鈕 #}
      {% include "partials/share-buttons.njk" %} {# 假設分享按鈕 partial 存在且可動態獲取當前頁面 URL #}

      {# 相關影片/系列推薦 - 根據藍圖，這部分的數據會由 Python 腳本預處理 #}
      {% if related_videos and related_videos.length %}
      <div class="bg-white p-6 rounded-lg shadow-md mb-6">
        <h3 class="text-xl font-heading font-bold text-brand-blue-700 mb-4">相關影片推薦</h3>
        <ul class="space-y-3">
          {% for item in related_videos %}
          <li><a href="{{ item.url }}" class="text-brand-blue-600 hover:text-brand-blue-800 hover:underline text-base">{{ item.title }}</a></li>
          {% endfor %}
        </ul>
      </div>
      {% endif %}

      {# 熱門項目推薦 - 來自 _data/popular.json #}
      {% if popular.items and popular.items.length %}
      <div class="bg-white p-6 rounded-lg shadow-md mb-6">
        <h3 class="text-xl font-heading font-bold text-brand-blue-700 mb-4">熱門項目</h3>
        <ul class="space-y-3">
          {% for item in popular.items %}
          <li><a href="{{ item.url }}" class="text-brand-blue-600 hover:text-brand-blue-800 hover:underline text-base">{{ item.title }}</a></li>
          {% endfor %}
        </ul>
      </div>
      {% endif %}

      {# 預約諮詢按鈕 #}
      <div class="bg-brand-blue-700 text-white p-6 rounded-lg shadow-lg text-center">
        <h3 class="text-xl font-heading font-bold mb-4">需要專業諮詢？</h3>
        <p class="mb-4 text-sm">我們的專業團隊隨時準備為您服務。</p>
        <a href="/appointment/" class="inline-block bg-brand-gold hover:bg-yellow-600 text-brand-blue-900 font-bold py-3 px-6 rounded-lg transition duration-200 shadow-md">立即預約</a>
      </div>
    </aside>
  </article>
</main>